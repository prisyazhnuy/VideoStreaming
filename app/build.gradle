apply plugin: 'com.android.application'

apply plugin: 'kotlin-android'

apply plugin: 'kotlin-android-extensions'

apply plugin: 'kotlin-kapt'

apply from: 'detekt.gradle'


android {
    compileSdkVersion rootProject.ext.compileSdkVersion as Integer
    buildToolsVersion rootProject.ext.buildToolsVersion as String

    defaultConfig {
        // TODO change package name
        applicationId "com.prisyazhnuy.streaming"
        minSdkVersion rootProject.ext.minSdkVersion as Integer
        targetSdkVersion rootProject.ext.targetSdkVersion as Integer
        versionCode 1
        versionName "1.0"
        testInstrumentationRunner "androidx.test.runner.AndroidJUnitRunner"
        multiDexEnabled true
        javaCompileOptions {
            annotationProcessorOptions {
                includeCompileClasspath true
            }
        }
    }

    compileOptions {
        sourceCompatibility JavaVersion.VERSION_1_8
        targetCompatibility JavaVersion.VERSION_1_8
    }

//    println("Debug Build number $buildNoDevelop")
//    println("Prod Build number $buildNoProd")
//    println("Build Git Hash $buildGitHash")

    signingConfigs {
        debug {
            storeFile file("./debug.keystore")
            storePassword "android"
            keyAlias "androiddebugkey"
            keyPassword "android"
        }
    }
    buildTypes {
        all {
//            buildConfigField "String", "GIT_HASH", "\"$buildGitHash\""
            proguardFiles getDefaultProguardFile('proguard-android.txt'), 'proguard-rules.pro'
            // TODO change name and password
            buildConfigField "String", "SECURE_PREF_NAME", '"name_prefs.xml"'
            buildConfigField "String", "SECURE_PREF_PASSWORD", '"qwerty123"'
            buildConfigField "Integer", "LOCALHOST_PORT", '8080'
//            buildConfigField "String", "WOWZA_HOST_ADDRESS", '"192.168.0.103"'
            buildConfigField "String", "WOWZA_HOST_ADDRESS", '"358928.entrypoint.cloud.wowza.com"'
            buildConfigField "Integer", "WOWZA_PORT", '1935'
//            buildConfigField "String", "WOWZA_APP_NAME", '"live"'
            buildConfigField "String", "WOWZA_APP_NAME", '"app-9915"'
//            buildConfigField "String", "WOWZA_STREAM_NAME", '"myStream"'
            buildConfigField "String", "WOWZA_STREAM_NAME", '"d5fb0d67"'
            buildConfigField "String", "WOWZA_API_KEY", '"GOSK-3A46-010C-044E-2484-8EEF"'
            buildConfigField "String", "TWILIO_ACCESS_TOKEN", '"eyJ0eXAiOiJKV1QiLCJhbGciOiJIUzI1NiIsImN0eSI6InR3aWxpby1mcGE7dj0xIn0.eyJqdGkiOiJTSzExOTRiYWRlN2FlYjE2ZTdlZGRmMzM1ODI1YTRlMGNjLTE1NTkzMjMwMjgiLCJpc3MiOiJTSzExOTRiYWRlN2FlYjE2ZTdlZGRmMzM1ODI1YTRlMGNjIiwic3ViIjoiQUMzMjc5MjhhNjJmNGU2YzM1MTJmNGNiYjQwNmRlNDllOSIsImV4cCI6MTU1OTMyNjYyOCwiZ3JhbnRzIjp7ImlkZW50aXR5IjoiZmlyc3QiLCJ2aWRlbyI6e319fQ.QhQDT57m7wJo3HTHsW8oDEZ-6eKz8N077Kd8Tj_gxZ8"'
        }
        // TODO change ENDPOINT
        debug {
            minifyEnabled false
            debuggable true
//            versionNameSuffix "." + buildNoDevelop + " Dev_" + buildGitHash
            signingConfig signingConfigs.debug
            buildConfigField "String", "ENDPOINT", '"https://project.endpoint.com"'
        }
        stage {
            minifyEnabled false
            debuggable true
//            versionNameSuffix "." + buildNoDevelop + " Stage_" + buildGitHash
            signingConfig signingConfigs.debug
            buildConfigField "String", "ENDPOINT", '"https://project.endpoint.com"'
        }
        release {
            minifyEnabled true
            debuggable false
//            versionNameSuffix "." + buildNoProd
            buildConfigField "String", "ENDPOINT", '"https://project.endpoint.com"'
        }
    }
    // for jenkins
    packagingOptions {
        exclude 'META-INF/NOTICE' // It is not include NOTICE file
        exclude 'META-INF/LICENSE' // It is not include LICENSE file
        exclude 'META-INF/rxjava.properties' // It is not include LICENSE file
        pickFirst '**/libjingle_peerconnection_so.so'
    }
    dexOptions {
        javaMaxHeapSize "4g"
    }

    repositories {
        flatDir {
            dirs 'libs'
        }
    }
}

dependencies {
    def testVersion = "1.1.0"
    implementation fileTree(include: ['*.jar'], dir: 'libs')
    testImplementation 'junit:junit:4.12'
    androidTestImplementation 'androidx.test.ext:junit:1.1.1'
    androidTestImplementation "androidx.test:runner:$testVersion"
    androidTestImplementation "androidx.test:rules:$testVersion"
    androidTestImplementation 'androidx.test.espresso:espresso-core:3.2.0'
    androidTestImplementation 'androidx.arch.core:core-testing:2.1.0'
    implementation 'com.squareup.okhttp3:mockwebserver:4.2.1'
    implementation "org.jetbrains.kotlin:kotlin-stdlib-jdk7:$kotlin_version"
    implementation "androidx.annotation:annotation:1.1.0"
    // Support
    implementation supportDependencies.lifecycleExtension
    implementation supportDependencies.constraintlayout
    implementation supportDependencies.recyclerView
    implementation supportDependencies.appCompat
    implementation supportDependencies.multiDex
    implementation supportDependencies.kotlin
    implementation supportDependencies.design
    // Bootstrap
    implementation bootstrapDependencies.validators
    implementation bootstrapDependencies.rxBus
    implementation bootstrapDependencies.core
    implementation bootstrapDependencies.ext
    // Stetho
    implementation "com.facebook.stetho:stetho:$stethoVersoin"
    // Room
    implementation roomDependencies.migration
    implementation roomDependencies.compiler
    implementation roomDependencies.runtime
    implementation roomDependencies.rxjava2
    implementation roomDependencies.testing
    implementation roomDependencies.common
    implementation roomDependencies.guava
    // RxJava
    implementation rxJavaDependencies.rxJava2
    // Retrofit
    implementation retrofitDependencies.converter
    implementation retrofitDependencies.retrofit
    implementation retrofitDependencies.adapter
    // Jackson
    implementation jacksonDependencies.interceptor
    implementation jacksonDependencies.annotations
    implementation jacksonDependencies.databind
    implementation jacksonDependencies.core
    implementation jacksonDependencies.joda
    // Secure preferences
    implementation securePreferencesDependencies.lib
    // LoggingInterceptor
    implementation('com.github.ihsanbal:LoggingInterceptor:2.0.7') {
        exclude group: 'org.json', module: 'json'
    }
    // OkHttpProfiler
    implementation 'com.itkacher.okhttpprofiler:okhttpprofiler:1.0.4'
    implementation 'com.github.tbruyelle:rxpermissions:0.10.2'
    // The GoCoder SDK library dependency declaration
    implementation 'com.wowza.gocoder.sdk.android:com.wowza.gocoder.sdk:1.5b7@aar'
    //Twilio
    implementation 'com.twilio:video-android:3.2.2'
    //Jitsi Meet
    implementation('org.jitsi.react:jitsi-meet-sdk:2.2.1') {
        transitive = true
        exclude group: "com.facebook.react", module: "react-native-webrtc"
    }
    // Glide
//    implementation('com.github.bumptech.glide:glide:4.7.1') {
//        exclude group: "com.android.support", module: "glide"
//    }
//    implementation('com.github.bumptech.glide:annotations:3.7.0') {
//        exclude group: "com.android.support", module: "annotations"
//    }
//    implementation ('com.github.bumptech.glide:glide:3.7.0') {
//        exclude group: "com.android.support", module: "glide"
//    }


}
